CREATE VIEW [dbo].[Kernel_View_Universe_Population]  
AS  
SELECT   
py.[idPayee],  
py.[codePayee],  
py.[id_sup],  
py.[is_active],  
py.[ss_nb],  
py.[lastname],  
py.[firstname],  
py.[email],  
py.[birth_date],  
py.[home_phone],  
py.[mobile_phone],  
py.[address_street],  
py.[address_postal_code],  
py.[address_city],  
py.[address_country],  
py.[family_situation],  
py.[children_nb],  
py.[image],  
py.[attachment],   
ext.[start_date_histo],  
ext.[end_date_histo],  
ext.[age],  
ext.[start_date_company],  
ext.[end_date_company],  
ext.[start_date_group],  
ext.[end_date_group],  
ext.[start_date_job],  
ext.[end_date_job],  
ext.[base_salary],  
ext.[base_salary_period],  
ext.[variable_period],  
ext.[nb_year_experience],  
ext.[months_per_year],  
ext.[hours_per_month],  
ext.[weight_structure_1],  
ext.[variable],ext.[company_car],  
ext.[id_category],ext.[id_grade],  
ext.[id_contract],ext.[id_agreement] ,  
ext.[id_gender],ext.[id_activity_status],  
ext.[id_job],ext.[id_department],  
ext.[id_organization],  
ext.[id_structure_1],  
ext.[id_structure_2],  
ext.[id_nationality],  
ext.[id_pool],  
ext.[id_job_country],  
ext.[id_benefit],  
ext.[id_salary_currency],   
ext.[short_name_job],  
ext.[short_name_structure],  
ext.[id_title],  
ext.[id_payment_currency],   
ext.short_name_contract
,ext.code_gender
,ext.short_name_gender
,ext.code_grade
FROM dbo.py_Payee as py   
LEFT OUTER JOIN Kernel_View_Payee_Ext as ext on py.idPayee = Ext.idPayee
WHERE GETDATE() >= ext.start_date_histo and GETDATE() < ext.end_date_histo